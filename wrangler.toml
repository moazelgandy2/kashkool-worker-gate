name = "kashkool-streaming-gate"
main = "src/index.mjs"
compatibility_date = "2026-02-20"

[observability]
enabled = true

[observability.logs]
enabled = true
head_sampling_rate = 0.25

[observability.traces]
enabled = true
head_sampling_rate = 0.05

[vars]
CONTROL_PLANE_BASE_URL = "https://diligent-manatee-129.eu-west-1.convex.site"
VIDEO_GATE_MAINTENANCE_MODE = "false"
VIDEO_GATE_MANIFEST_PER_MINUTE = "60"
VIDEO_GATE_PLAYLIST_PER_MINUTE = "120"
VIDEO_GATE_SEGMENT_PER_MINUTE = "1600"
VIDEO_GATE_KEY_PER_MINUTE = "20"
VIDEO_GATE_KEY_REPLAY_TTL_SECONDS = "900"
VIDEO_GATE_KEY_JTI_MAX_REUSE = "5"
VIDEO_GATE_SESSION_VALIDATION_CACHE_TTL_SECONDS = "60"
VIDEO_GATE_STRICT_REQUEST_CONTEXT = "true"
VIDEO_GATE_ALLOWED_ORIGINS = "https://kashkool.online,https://*.kashkool.online"
VIDEO_GATE_ABUSE_AUTOBLOCK_ENABLED = "true"
VIDEO_GATE_ABUSE_BLOCK_TTL_SECONDS = "600"
VIDEO_GATE_ABUSE_IP_BLOCK_ENABLED = "true"

[[r2_buckets]]
binding = "VIDEO_DELIVERY_BUCKET"
bucket_name = "kashkool-delivery"

[[kv_namespaces]]
binding = "VIDEO_GATE_KV"
id = "73f44a3c2762496d93e12e8a9378d4c1"
