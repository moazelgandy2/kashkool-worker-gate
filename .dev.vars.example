# Kashkool Worker Gate Environment Variables
#
# Use this file for local `wrangler dev` only.
# In deployed environments, set secrets with `wrangler secret put` and
# keep non-secret vars in wrangler.toml [vars].

# ============================================
# Core security secrets (required)
# ============================================
VIDEO_PLAYBACK_TOKEN_SECRET=
VIDEO_GATE_VALIDATION_SECRET=
VIDEO_KEY_ENCRYPTION_SECRET=

# ============================================
# Control-plane endpoint model
# ============================================
CONTROL_PLANE_BASE_URL=
# Optional explicit overrides (normally derived from CONTROL_PLANE_BASE_URL):
# VIDEO_GATE_VALIDATION_URL=
# VIDEO_GATE_KEY_URL=
# VIDEO_GATE_EVENT_URL=

# ============================================
# Operations
# ============================================
VIDEO_GATE_MAINTENANCE_MODE=false

# ============================================
# Rate limits / replay
# ============================================
VIDEO_GATE_MANIFEST_PER_MINUTE=60
VIDEO_GATE_PLAYLIST_PER_MINUTE=120
VIDEO_GATE_SEGMENT_PER_MINUTE=1600
VIDEO_GATE_KEY_PER_MINUTE=20
VIDEO_GATE_KEY_REPLAY_TTL_SECONDS=900
VIDEO_GATE_KEY_JTI_MAX_REUSE=5
VIDEO_GATE_SESSION_VALIDATION_CACHE_TTL_SECONDS=60
VIDEO_GATE_SESSION_VALIDATION_CACHE_MAX_FOR_HEARTBEAT_SECONDS=15
VIDEO_GATE_ABUSE_AUTOBLOCK_ENABLED=true
VIDEO_GATE_ABUSE_BLOCK_TTL_SECONDS=600
VIDEO_GATE_ABUSE_IP_BLOCK_ENABLED=true
VIDEO_GATE_ENFORCE_SESSION_IP_STICKY=true
VIDEO_GATE_SESSION_IP_STICKY_TTL_SECONDS=1200
VIDEO_GATE_IP_STICKY_GRACE_ENABLED=true
VIDEO_GATE_IP_STICKY_GRACE_SECONDS=60
VIDEO_GATE_REQUIRE_HEARTBEAT=true
VIDEO_GATE_HEARTBEAT_MAX_AGE_SECONDS=40

# ============================================
# Request context hardening (optional)
# ============================================
VIDEO_GATE_STRICT_REQUEST_CONTEXT=false
VIDEO_GATE_ALLOWED_ORIGINS=
VIDEO_GATE_REQUIRE_ORIGIN=true
VIDEO_GATE_REQUIRE_SEC_FETCH=true
VIDEO_GATE_BLOCK_KNOWN_DOWNLOADER_UA=true

# Required binding in wrangler.toml: VIDEO_DELIVERY_BUCKET
# Optional binding in wrangler.toml: VIDEO_GATE_KV
# Source of truth: ../ENV_CATALOG.md
